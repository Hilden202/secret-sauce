name: Send Secret

on:
  push:
    branches:
      - main
  workflow_dispatch:
  pull_request:
    branches:
      - main
jobs:
  demo-secret:
    name: Demo of secret
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v5

      - name: Verify secret
        run: |
          if [ -z "${{ secrets.FAVOURITE_NUMBER }}" ]; then
            echo "‚ö†Ô∏è  WARNING: Secret 'FAVOURITE_NUMBER' is not configured"
            echo ""
            echo "To set up this secret:"
            echo "1. Go to your repository on GitHub"
            echo "2. Click Settings ‚Üí Secrets and variables ‚Üí Actions"
            echo "3. Click 'New repository secret'"
            echo "4. Name: FAVOURITE_NUMBER"
            echo "5. Value: Your webhook URL (e.g., Slack, Discord, or any HTTP endpoint)"
            echo "6. Click 'Add secret'"
            echo ""
            echo "This workflow will continue but skip the notification step."
          else
            echo "‚úÖ Secret 'FAVOURITE_NUMBER' is configured"
            echo ""
            echo "Note: The secret value is automatically masked in logs."
            echo "Even if we tried to print it, GitHub would replace it with ***"
          fi

      - name: Print secret
        run: |
          echo "===================================="
          echo "Github Actions Secret Demo"
          echo "===================================="
          echo ""
          echo "This workflow demonstrates how to use secrets in GitHub Actions."
          echo ""
          

          echo "${{ secrets.FAVOURITE_NUMBER }}"
          # They are automatically masked in logs (replaced with ***)

      - name: Send to Discord
        env:
          WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          PAYLOAD='{
            "username": "GitHub Actions",
            "content": "üöÄ Workflow k√∂rdes i $GITHUB_REPOSITORY p√• branch $GITHUB_REF"
          }'
          curl -H "Content-Type: application/json" \
               -d "$PAYLOAD" \
               "$WEBHOOK_URL"    
